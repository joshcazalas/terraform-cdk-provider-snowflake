name: Check for New Release

on:
  workflow_dispatch
  # schedule:
  #   # Define your schedule here (e.g., every day)
  #   - cron: '0 6 * * *'

jobs:
  check-release:
    runs-on: ubuntu-latest

    steps:
      - name: Set up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: 18
          
      - name: Install Dependencies
        run: npm install
        
      - name: Check for New Release
        id: check-release
        uses: actions/github-script@v6
        with:
          script: |
            const response = await github.repos.getLatestRelease({
              owner: 'Snowflake-Labs',
              repo: 'terraform-provider-snowflake'
            });
            const latestReleaseTag = response.data.tag_name;

            console.log(`Latest release tag: ${latestReleaseTag}`);
        env:
          GITHUB_TOKEN: ${{ secrets.EXTERNAL_REPO_PAT }}
